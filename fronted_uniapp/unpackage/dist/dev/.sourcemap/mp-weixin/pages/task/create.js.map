{"version":3,"sources":["uni-app:///main.js","webpack:///R:/Code_Repository/TrustFulfillment/fronted_uniapp/pages/task/create.vue?fad7","webpack:///R:/Code_Repository/TrustFulfillment/fronted_uniapp/pages/task/create.vue?296d","webpack:///R:/Code_Repository/TrustFulfillment/fronted_uniapp/pages/task/create.vue?3b23","webpack:///R:/Code_Repository/TrustFulfillment/fronted_uniapp/pages/task/create.vue?943d","uni-app:///pages/task/create.vue","webpack:///R:/Code_Repository/TrustFulfillment/fronted_uniapp/pages/task/create.vue?e2ca","webpack:///R:/Code_Repository/TrustFulfillment/fronted_uniapp/pages/task/create.vue?38a6"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page","data","statusBarHeight","currentStep","submitting","uploadedFiles","totalBudget","selectedPlanId","categoryTree","categoryColumns","categoryIndexes","paymentPlans","id","name","desc","stages","percent","milestone","riskNote","stageType","formData","title","categoryId","categoryName","techStack","description","features","startTime","deliveryTime","computed","totalAmount","totalPercent","onLoad","methods","loadCategories","res","console","col1","children","col2","col3","goBack","uni","updateCategoryName","idx1","idx2","idx3","onCategoryColumnChange","newCol3","newCol2","onCategoryChange","onStartTimeChange","onDeliveryTimeChange","chooseFile","count","type","success","files","file","uploadFile","token","uploadTask","url","filePath","header","icon","removeFile","isImage","selectPlan","s","amount","onBudgetChange","recalculateStages","stage","updateStageAmount","addStage","removeStage","getStageColor","nextStep","prevStep","validateStep1","validateStep2","handleSubmit","submitData","docUrls","method","setTimeout"],"mappings":";;;;;;;;;;;;;AAAA;AAGA;AACA;AAHA;AACAA,EAAE,CAACC,iCAAiC,GAAGC,mBAAmB;AAG1DC,UAAU,CAACC,eAAI,CAAC,C;;;;;;;;;;;;;ACLhB;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+H;AAC/H;AAC0D;AACL;AACsC;;;AAG3F;AACqK;AACrK,gBAAgB,+KAAU;AAC1B,EAAE,4EAAM;AACR,EAAE,6FAAM;AACR,EAAE,sGAAe;AACjB;AACA;AACA;AACA;AACA;AACA,EAAE,iGAAU;AACZ;AACA;;AAEA;AACe,gF;;;;;;;;;;;;ACvBf;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,SAAS;AACT;AACA;AACA,MAAM;AACN;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA,OAAO;AACP;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACnEA;AAAA;AAAA;AAAA;AAAgmB,CAAgB,0nBAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;AC8TpnB;AACA;AACA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,eAEA;EACAC;IACA;MACAC;MACAC;MACAC;MACAC;MACAC;MACAC;MAEA;MACAC;MAAA;MACAC;MAAA;MACAC;MAAA;;MAEAC,eACA;QACAC;QACAC;QACAC;QACAC,SACA;UAAAF;UAAAG;UAAAC;UAAAC;UAAAC;QAAA,GACA;UAAAN;UAAAG;UAAAC;UAAAC;UAAAC;QAAA,GACA;UAAAN;UAAAG;UAAAC;UAAAC;UAAAC;QAAA;MAEA,GACA;QACAP;QACAC;QACAC;QACAC,SACA;UAAAF;UAAAG;UAAAC;UAAAC;UAAAC;QAAA,GACA;UAAAN;UAAAG;UAAAC;UAAAC;UAAAC;QAAA;MAEA,GACA;QACAP;QACAC;QACAC;QACAC,SACA;UAAAF;UAAAG;UAAAC;UAAAC;UAAAC;QAAA,GACA;UAAAN;UAAAG;UAAAC;UAAAC;UAAAC;QAAA,GACA;UAAAN;UAAAG;UAAAC;UAAAC;UAAAC;QAAA;MAEA,GACA;QACAP;QACAC;QACAC;QACAC,SACA;UAAAF;UAAAG;UAAAC;UAAAC;UAAAC;QAAA,GACA;UAAAN;UAAAG;UAAAC;UAAAC;UAAAC;QAAA;MAEA,EACA;MAEAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAC;QACAb;MACA;IACA;EACA;EAEAc;IACAC;MACA;QAAA;MAAA;IACA;IACAC;MACA;QAAA;MAAA;IACA;EACA;EAEAC;IACA;IACA;;IAEA;IACA;;IAEA;IACA;EACA;EAEAC;IACAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBAAA;gBAAA;gBAAA,OAEA;cAAA;gBAAAC;gBACAC;gBAEA;kBACA;;kBAEA;kBACAC;oBAAA;sBACAzB;sBACAC;sBACAyB;oBACA;kBAAA,IAEA;kBACAC;kBACA;oBACAA;sBAAA;wBACA3B;wBACAC;wBACAyB;sBACA;oBAAA;kBACA;;kBAEA;kBACAE;kBACA;oBACAA;sBAAA;wBACA5B;wBACAC;sBACA;oBAAA;kBACA;;kBAEA;kBACA;kBACA;kBACA;kBAEAuB;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEAA;gBACA;gBACA,yBACA,CACA;kBAAAxB;kBAAAC;kBAAAyB;gBAAA,GACA;kBAAA1B;kBAAAC;kBAAAyB;gBAAA,EACA,EACA,CACA;kBAAA1B;kBAAAC;kBAAAyB;gBAAA,GACA;kBAAA1B;kBAAAC;kBAAAyB;gBAAA,EACA,EACA,CACA;kBAAA1B;kBAAAC;gBAAA,GACA;kBAAAD;kBAAAC;gBAAA,EACA,CACA;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;IACA4B;MACA;QACA;MACA;QACAC;MACA;IACA;IAEA;IACAC;MACA;QAAAC;QAAAC;QAAAC;MACA;MACA;MACA;;MAEA;MACA;QACA;QACA;QACA;MACA;MAEA;QACA;QACA;QACA;MACA;QACA;QACA;QACA;MACA;QACA;QACA;QACA;MACA;QACA;QACA;QACA;MACA;MAEAV;IACA;IAEA;IACAW;MACA;MACA;;MAEAX;MAEA;QACA;QACA;QAEA;UACA;UACA;YAAA;cACAxB;cACAC;cACAyB;YACA;UAAA;;UAEA;UACA;UACA;YACAU;cAAA;gBACApC;gBACAC;cACA;YAAA;UACA;;UAEA;UACA,wBACA,yBACAoC,SACAD,QACA;UACA;QACA;MACA;QACA;QACA;QAEA;UACA;YAAA;cACApC;cACAC;YACA;UAAA;UAEA,wBACA,yBACA,yBACAmC,QACA;UACA;QACA;UACA;UACA,wBACA,yBACA,yBACA,GACA;UACA;QACA;MACA;QACA;QACA;MACA;IACA;IAEA;IACAE;MACA;MACA;IACA;IAEAC;MACA;IACA;IAEAC;MACA;IACA;IAEAC;MAAA;MACAX;QACAY;QACAC;QACAC;UAAA;YAAA;YAAA;cAAA;gBAAA;kBAAA;oBACAC;oBAAA,uCACAA;oBAAA;oBAAA;kBAAA;oBAAA;sBAAA;sBAAA;oBAAA;oBAAAC;oBAAA;oBAAA,OACA;kBAAA;oBAAA;oBAAA;kBAAA;oBAAA;oBAAA;kBAAA;oBAAA;oBAAA;oBAAA;kBAAA;oBAAA;oBAAA;oBAAA;kBAAA;kBAAA;oBAAA;gBAAA;cAAA;YAAA;UAAA,CAEA;UAAA;YAAA;UAAA;UAAA;QAAA;MACA;IACA;IAEAC;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACAjB;kBAAArB;gBAAA;gBACA;kBACAuC;kBACAC;oBACAC;oBACAC;oBACAlD;oBACAmD;sBACA;oBACA;oBACA5C;sBACAmC;oBACA;oBACAC;sBACA;sBACA;wBACA;0BACA3C;0BACAiD;wBACA;wBACApB;0BAAArB;0BAAA4C;wBAAA;sBACA;oBACA;kBACA;gBACA;kBACAvB;oBAAArB;oBAAA4C;kBAAA;gBACA;kBACAvB;gBACA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IACA;IAEAwB;MACA;IACA;IAEAC;MACA;MACA;IACA;IAEAC;MAAA;MACA;MACA;QAAA,uCACAC;UACAC;QAAA;MAAA,CACA;IACA;IAEAC;MACA;IACA;IAEAC;MAAA;MACA;QACAC;MACA;IACA;IAEAC;MACA;IACA;IAEAC;MACA;MACA;QACA9D;QACAG;QACAsD;QACArD;QACAC;QACAC;MACA;MACA;IACA;IAEAyD;MACA;MACA;IACA;IAEAC;MACA;MACA;IACA;IAEAC;MACA;QACA;MACA;QACA;MACA;MACA;IACA;IAEAC;MACA;IACA;IAEAC;MACA;QACAtC;UAAArB;UAAA4C;QAAA;QACA;MACA;MACA;QACAvB;UAAArB;UAAA4C;QAAA;QACA;MACA;MACA;QACAvB;UAAArB;UAAA4C;QAAA;QACA;MACA;MACA;QACAvB;UAAArB;UAAA4C;QAAA;QACA;MACA;MACA;QACAvB;UAAArB;UAAA4C;QAAA;QACA;MACA;MACA;IACA;IAEAgB;MACA;QACAvC;UAAArB;UAAA4C;QAAA;QACA;MACA;MACA;QAAA;MAAA;QACAvB;UAAArB;UAAA4C;QAAA;QACA;MACA;MACA;QACAvB;UAAArB;UAAA4C;QAAA;QACA;MACA;MACA;IACA;IAEAiB;MAAA;MAAA;QAAA;QAAA;UAAA;YAAA;cAAA;gBACA;gBAAA;gBAEAC;kBACA9D;kBACAC;kBACAE;kBACAC;kBACAC;kBACA0D;oBAAA;kBAAA;kBACAzD;kBACAC;kBACAb;oBAAA;sBACAF;sBACAyD;sBACAtD;sBACAC;sBACAC;sBACAC;oBACA;kBAAA;gBACA;gBAAA;gBAAA,OAEA;kBACA2C;kBACAuB;kBACApF;gBACA;cAAA;gBAJAkC;gBAMAO;kBAAArB;kBAAA4C;gBAAA;gBACAqB;kBACA5C;oBAAAoB;kBAAA;gBACA;gBAAA;gBAAA;cAAA;gBAAA;gBAAA;gBAEApB;kBAAArB;kBAAA4C;gBAAA;cAAA;gBAAA;gBAEA;gBAAA;cAAA;cAAA;gBAAA;YAAA;UAAA;QAAA;MAAA;IAEA;EACA;AACA;AAAA,2B;;;;;;;;;;;;;ACrxBA;AAAA;AAAA;AAAA;AAAmqC,CAAgB,yoCAAG,EAAC,C;;;;;;;;;;;ACAvrC;AACA,OAAO,KAAU,EAAE,kBAKd","file":"pages/task/create.js","sourcesContent":["import 'uni-pages';\n// @ts-ignore\nwx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/task/create.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./create.vue?vue&type=template&id=d90dac46&scoped=true&\"\nvar renderjs\nimport script from \"./create.vue?vue&type=script&lang=js&\"\nexport * from \"./create.vue?vue&type=script&lang=js&\"\nimport style0 from \"./create.vue?vue&type=style&index=0&id=d90dac46&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\runtime\\\\componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"d90dac46\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/task/create.vue\"\nexport default component.exports","export * from \"-!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\templateLoader.js??vue-loader-options!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--17-0!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\template.js!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-uni-app-loader\\\\page-meta.js!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./create.vue?vue&type=template&id=d90dac46&scoped=true&\"","var components\nvar render = function () {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n  var g0 = _vm.currentStep === 1 ? _vm.formData.description.length : null\n  var g1 = _vm.currentStep === 1 ? _vm.formData.features.length : null\n  var l0 =\n    _vm.currentStep === 1\n      ? _vm.__map(_vm.uploadedFiles, function (file, index) {\n          var $orig = _vm.__get_orig(file)\n          var m0 = _vm.isImage(file.name)\n          return {\n            $orig: $orig,\n            m0: m0,\n          }\n        })\n      : null\n  var g2 = _vm.currentStep === 1 ? _vm.uploadedFiles.length : null\n  var l1 =\n    _vm.currentStep === 2\n      ? _vm.__map(_vm.formData.stages, function (stage, index) {\n          var $orig = _vm.__get_orig(stage)\n          var m1 = _vm.getStageColor(index)\n          var g3 = _vm.formData.stages.length\n          var g4 = stage.amount.toLocaleString()\n          return {\n            $orig: $orig,\n            m1: m1,\n            g3: g3,\n            g4: g4,\n          }\n        })\n      : null\n  var g5 = _vm.currentStep === 2 ? _vm.formData.stages.length : null\n  var g6 = _vm.currentStep === 3 ? _vm.totalAmount.toLocaleString() : null\n  var l2 =\n    _vm.currentStep === 3\n      ? _vm.__map(_vm.formData.stages, function (stage, index) {\n          var $orig = _vm.__get_orig(stage)\n          var m2 = _vm.getStageColor(index)\n          var g7 = stage.amount.toLocaleString()\n          return {\n            $orig: $orig,\n            m2: m2,\n            g7: g7,\n          }\n        })\n      : null\n  _vm.$mp.data = Object.assign(\n    {},\n    {\n      $root: {\n        g0: g0,\n        g1: g1,\n        l0: l0,\n        g2: g2,\n        l1: l1,\n        g5: g5,\n        g6: g6,\n        l2: l2,\n      },\n    }\n  )\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./create.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\babel-loader\\\\lib\\\\index.js!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--13-1!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\script.js!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./create.vue?vue&type=script&lang=js&\"","<template>\r\n  <view class=\"page\">\r\n    <!-- 自定义导航栏 -->\r\n    <view class=\"custom-navbar\" :style=\"{ paddingTop: statusBarHeight + 'px' }\">\r\n      <view class=\"navbar-content\">\r\n        <view class=\"navbar-left\" @click=\"goBack\">\r\n          <text class=\"back-icon\">←</text>\r\n        </view>\r\n        <view class=\"navbar-title\">发布任务</view>\r\n        <view class=\"navbar-right\"></view>\r\n      </view>\r\n    </view>\r\n\r\n    <scroll-view scroll-y class=\"content-scroll\">\r\n      <!-- 步骤指示器 -->\r\n      <view class=\"steps\">\r\n        <view class=\"step\" :class=\"{ active: currentStep >= 1 }\">\r\n          <view class=\"step-number\">1</view>\r\n          <text class=\"step-text\">项目需求</text>\r\n        </view>\r\n        <view class=\"step-line\" :class=\"{ active: currentStep >= 2 }\"></view>\r\n        <view class=\"step\" :class=\"{ active: currentStep >= 2 }\">\r\n          <view class=\"step-number\">2</view>\r\n          <text class=\"step-text\">资金托管</text>\r\n        </view>\r\n        <view class=\"step-line\" :class=\"{ active: currentStep >= 3 }\"></view>\r\n        <view class=\"step\" :class=\"{ active: currentStep >= 3 }\">\r\n          <view class=\"step-number\">3</view>\r\n          <text class=\"step-text\">确认发布</text>\r\n        </view>\r\n      </view>\r\n\r\n      <!-- 第一步：项目需求 -->\r\n      <view v-if=\"currentStep === 1\" class=\"step-content\">\r\n        <view class=\"section\">\r\n          <view class=\"section-title\">项目基本信息</view>\r\n          \r\n          <view class=\"form-item\">\r\n            <view class=\"form-label required\">项目名称</view>\r\n            <input \r\n              class=\"form-input\" \r\n              v-model=\"formData.title\" \r\n              placeholder=\"例如：跨境支付系统前端开发\"\r\n              placeholder-class=\"placeholder\"\r\n            />\r\n          </view>\r\n\r\n          <view class=\"form-item\">\r\n            <view class=\"form-label required\">项目分类</view>\r\n            <picker \r\n              mode=\"multiSelector\" \r\n              :range=\"categoryColumns\" \r\n              range-key=\"name\"\r\n              :value=\"categoryIndexes\"\r\n              @change=\"onCategoryChange\"\r\n              @columnchange=\"onCategoryColumnChange\"\r\n            >\r\n              <view class=\"form-picker\" :class=\"{ placeholder: !formData.categoryName }\">\r\n                {{ formData.categoryName || '请选择项目分类' }}\r\n              </view>\r\n            </picker>\r\n            <view class=\"form-tip\">三列分别选择：一级分类、二级分类、三级分类</view>\r\n          </view>\r\n\r\n          <view class=\"form-item\">\r\n            <view class=\"form-label\">技术要求</view>\r\n            <input \r\n              class=\"form-input\" \r\n              v-model=\"formData.techStack\" \r\n              placeholder=\"例如：Vue3, TypeScript, Node.js\"\r\n              placeholder-class=\"placeholder\"\r\n            />\r\n          </view>\r\n\r\n          <view class=\"form-item\">\r\n            <view class=\"form-label required\">需求简述</view>\r\n            <textarea \r\n              class=\"form-textarea\" \r\n              v-model=\"formData.description\" \r\n              placeholder=\"简要描述项目背景和核心需求...\"\r\n              placeholder-class=\"placeholder\"\r\n              :maxlength=\"500\"\r\n            />\r\n            <view class=\"char-count\">{{ formData.description.length }}/500</view>\r\n          </view>\r\n\r\n          <view class=\"form-item\">\r\n            <view class=\"form-label\">详细需求</view>\r\n            <textarea \r\n              class=\"form-textarea large\" \r\n              v-model=\"formData.features\" \r\n              placeholder=\"详细描述功能模块、交付标准等...&#10;&#10;例如：&#10;1. 用户登录注册模块&#10;2. 商品列表展示&#10;3. 购物车功能\"\r\n              placeholder-class=\"placeholder\"\r\n              :maxlength=\"2000\"\r\n            />\r\n            <view class=\"char-count\">{{ formData.features.length }}/2000</view>\r\n          </view>\r\n\r\n          <view class=\"form-item\">\r\n            <view class=\"form-label\">开发文档</view>\r\n            <view class=\"upload-list\">\r\n              <view class=\"upload-item\" v-for=\"(file, index) in uploadedFiles\" :key=\"index\">\r\n                <image v-if=\"isImage(file.name)\" class=\"upload-preview\" :src=\"file.url\" mode=\"aspectFill\" />\r\n                <view v-else class=\"upload-file\">\r\n                  <text class=\"iconfont icon-file\"></text>\r\n                  <text class=\"file-name\">{{ file.name }}</text>\r\n                </view>\r\n                <view class=\"upload-delete\" @click=\"removeFile(index)\">\r\n                  <text class=\"iconfont icon-close\"></text>\r\n                </view>\r\n              </view>\r\n              <view class=\"upload-btn\" @click=\"chooseFile\" v-if=\"uploadedFiles.length < 9\">\r\n                <text class=\"iconfont icon-plus\"></text>\r\n                <text class=\"upload-text\">上传文件</text>\r\n              </view>\r\n            </view>\r\n            <view class=\"form-tip\">支持图片、PDF、Word等，最多9个文件</view>\r\n          </view>\r\n\r\n          <view class=\"form-row\">\r\n            <view class=\"form-item half\">\r\n              <view class=\"form-label required\">开始时间</view>\r\n              <picker mode=\"date\" :value=\"formData.startTime\" @change=\"onStartTimeChange\">\r\n                <view class=\"form-picker\" :class=\"{ placeholder: !formData.startTime }\">\r\n                  {{ formData.startTime || '选择日期' }}\r\n                </view>\r\n              </picker>\r\n            </view>\r\n            <view class=\"form-item half\">\r\n              <view class=\"form-label required\">交付日期</view>\r\n              <picker mode=\"date\" :value=\"formData.deliveryTime\" @change=\"onDeliveryTimeChange\">\r\n                <view class=\"form-picker\" :class=\"{ placeholder: !formData.deliveryTime }\">\r\n                  {{ formData.deliveryTime || '选择日期' }}\r\n                </view>\r\n              </picker>\r\n            </view>\r\n          </view>\r\n        </view>\r\n\r\n        <view class=\"btn-group\">\r\n          <button class=\"btn btn-primary\" @click=\"nextStep\">下一步</button>\r\n        </view>\r\n      </view>\r\n\r\n      <!-- 第二步：资金托管 -->\r\n      <view v-if=\"currentStep === 2\" class=\"step-content\">\r\n        <view class=\"section\">\r\n          <view class=\"section-title\">选择付款方案</view>\r\n          <view class=\"plan-list\">\r\n            <view \r\n              class=\"plan-card\" \r\n              v-for=\"plan in paymentPlans\" \r\n              :key=\"plan.id\"\r\n              :class=\"{ active: selectedPlanId === plan.id }\"\r\n              @click=\"selectPlan(plan)\"\r\n            >\r\n              <view class=\"plan-header\">\r\n                <text class=\"plan-name\">{{ plan.name }}</text>\r\n                <view class=\"plan-check\" v-if=\"selectedPlanId === plan.id\">\r\n                  <text class=\"iconfont icon-check\"></text>\r\n                </view>\r\n              </view>\r\n              <view class=\"plan-desc\">{{ plan.desc }}</view>\r\n            </view>\r\n          </view>\r\n        </view>\r\n\r\n        <view class=\"section\">\r\n          <view class=\"section-title\">项目总预算</view>\r\n          <view class=\"budget-input\">\r\n            <text class=\"budget-symbol\">¥</text>\r\n            <input \r\n              class=\"budget-value\" \r\n              type=\"digit\" \r\n              v-model=\"totalBudget\" \r\n              placeholder=\"请输入金额\"\r\n              @input=\"onBudgetChange\"\r\n            />\r\n          </view>\r\n          <view class=\"form-tip\">最低100元，平台将收取5%服务费</view>\r\n        </view>\r\n\r\n        <view class=\"section\">\r\n          <view class=\"section-title\">付款阶段</view>\r\n          <view class=\"stage-list\">\r\n            <view class=\"stage-card\" v-for=\"(stage, index) in formData.stages\" :key=\"index\">\r\n              <view class=\"stage-header\">\r\n                <view class=\"stage-number\" :style=\"{ background: getStageColor(index) }\">\r\n                  {{ index + 1 }}\r\n                </view>\r\n                <input \r\n                  class=\"stage-name\" \r\n                  v-model=\"stage.name\" \r\n                  placeholder=\"阶段名称\"\r\n                />\r\n                <view class=\"stage-delete\" v-if=\"formData.stages.length > 2\" @click=\"removeStage(index)\">\r\n                  <text class=\"iconfont icon-delete\"></text>\r\n                </view>\r\n              </view>\r\n              \r\n              <view class=\"stage-amount\">\r\n                <view class=\"amount-input\">\r\n                  <input \r\n                    type=\"digit\" \r\n                    v-model=\"stage.percent\" \r\n                    @input=\"updateStageAmount(index)\"\r\n                  />\r\n                  <text>%</text>\r\n                </view>\r\n                <text class=\"amount-value\">¥{{ stage.amount.toLocaleString() }}</text>\r\n              </view>\r\n\r\n              <view class=\"stage-field\">\r\n                <text class=\"field-label\">付款节点</text>\r\n                <input \r\n                  class=\"field-input\" \r\n                  v-model=\"stage.milestone\" \r\n                  placeholder=\"如：合同签订当日\"\r\n                />\r\n              </view>\r\n\r\n              <view class=\"stage-field\">\r\n                <text class=\"field-label\">风险说明</text>\r\n                <textarea \r\n                  class=\"field-textarea\" \r\n                  v-model=\"stage.riskNote\" \r\n                  placeholder=\"如：客户跑路可覆盖30%人力成本\"\r\n                  :maxlength=\"200\"\r\n                />\r\n              </view>\r\n            </view>\r\n          </view>\r\n\r\n          <view class=\"add-stage-btn\" v-if=\"formData.stages.length < 5\" @click=\"addStage\">\r\n            <text class=\"iconfont icon-plus\"></text>\r\n            <text>添加结算节点</text>\r\n          </view>\r\n\r\n          <view class=\"percent-warning\" v-if=\"totalPercent !== 100\">\r\n            <text class=\"iconfont icon-warning\"></text>\r\n            <text>当前比例合计 {{ totalPercent }}%，需等于 100%</text>\r\n          </view>\r\n        </view>\r\n\r\n        <view class=\"info-box\">\r\n          <view class=\"info-title\">\r\n            <text class=\"iconfont icon-info\"></text>\r\n            <text>分期付款方案说明</text>\r\n          </view>\r\n          <view class=\"info-item\">• 352方案：30%定金 + 50%中期款 + 20%尾款</view>\r\n          <view class=\"info-item\">• 37方案：30%定金 + 70%尾款（无质保）</view>\r\n          <view class=\"info-item\">• 442方案：40%定金 + 40%中期款 + 20%尾款</view>\r\n        </view>\r\n\r\n        <view class=\"btn-group\">\r\n          <button class=\"btn btn-default\" @click=\"prevStep\">上一步</button>\r\n          <button class=\"btn btn-primary\" @click=\"nextStep\">下一步</button>\r\n        </view>\r\n      </view>\r\n\r\n      <!-- 第三步：确认发布 -->\r\n      <view v-if=\"currentStep === 3\" class=\"step-content\">\r\n        <view class=\"section\">\r\n          <view class=\"section-title\">项目信息</view>\r\n          <view class=\"confirm-item\">\r\n            <text class=\"confirm-label\">项目名称</text>\r\n            <text class=\"confirm-value\">{{ formData.title }}</text>\r\n          </view>\r\n          <view class=\"confirm-item\">\r\n            <text class=\"confirm-label\">项目分类</text>\r\n            <text class=\"confirm-value\">{{ formData.categoryName }}</text>\r\n          </view>\r\n          <view class=\"confirm-item\">\r\n            <text class=\"confirm-label\">技术要求</text>\r\n            <text class=\"confirm-value\">{{ formData.techStack || '无' }}</text>\r\n          </view>\r\n          <view class=\"confirm-item\">\r\n            <text class=\"confirm-label\">项目周期</text>\r\n            <text class=\"confirm-value\">{{ formData.startTime }} 至 {{ formData.deliveryTime }}</text>\r\n          </view>\r\n        </view>\r\n\r\n        <view class=\"section\">\r\n          <view class=\"section-title\">资金托管</view>\r\n          <view class=\"confirm-budget\">\r\n            <text class=\"budget-label\">托管总金额</text>\r\n            <text class=\"budget-amount\">¥{{ totalAmount.toLocaleString() }}</text>\r\n          </view>\r\n          <view class=\"stage-summary\">\r\n            <view class=\"summary-item\" v-for=\"(stage, index) in formData.stages\" :key=\"index\">\r\n              <view class=\"summary-dot\" :style=\"{ background: getStageColor(index) }\"></view>\r\n              <text class=\"summary-name\">{{ stage.name }}</text>\r\n              <text class=\"summary-percent\">{{ stage.percent }}%</text>\r\n              <text class=\"summary-amount\">¥{{ stage.amount.toLocaleString() }}</text>\r\n            </view>\r\n          </view>\r\n        </view>\r\n\r\n        <view class=\"warning-box\">\r\n          <text class=\"iconfont icon-shield\"></text>\r\n          <text class=\"warning-text\">任务发布后等待商家接单。商家接单后，您需要进行资金托管，订单才正式开始执行。</text>\r\n        </view>\r\n\r\n        <view class=\"btn-group\">\r\n          <button class=\"btn btn-default\" @click=\"prevStep\">上一步</button>\r\n          <button class=\"btn btn-primary\" :loading=\"submitting\" @click=\"handleSubmit\">\r\n            {{ submitting ? '发布中...' : '确认发布' }}\r\n          </button>\r\n        </view>\r\n      </view>\r\n\r\n      <!-- 底部安全距离 -->\r\n      <view style=\"height: 40rpx;\"></view>\r\n    </scroll-view>\r\n  </view>\r\n</template>\r\n\r\n<script>\r\nimport { ref, reactive, computed } from 'vue'\r\nimport { request } from '@/utils/request'\r\nimport { getBusinessCategories } from '@/utils/api'\r\n\r\nexport default {\r\n  data() {\r\n    return {\r\n      statusBarHeight: 0,\r\n      currentStep: 1,\r\n      submitting: false,\r\n      uploadedFiles: [],\r\n      totalBudget: 10000,\r\n      selectedPlanId: '352',\r\n      \r\n      // 分类相关 - 三列选择器\r\n      categoryTree: [],                    // 原始树形数据\r\n      categoryColumns: [[], [], []],       // 三列数据 [一级, 二级, 三级]\r\n      categoryIndexes: [0, 0, 0],          // 当前选中的索引 [一级索引, 二级索引, 三级索引]\r\n      \r\n      paymentPlans: [\r\n        {\r\n          id: '352',\r\n          name: '352方案（推荐）',\r\n          desc: '30%定金 + 50%中期款 + 20%质保款',\r\n          stages: [\r\n            { name: '首付款', percent: 30, milestone: '合同签订后托管', riskNote: '覆盖30%人力成本', stageType: 1 },\r\n            { name: '尾款', percent: 50, milestone: '项目验收通过后支付', riskNote: '验收通过后释放', stageType: 2 },\r\n            { name: '质保款', percent: 20, milestone: '质保期15天后释放', riskNote: '15天免费维护保障', stageType: 3 }\r\n          ]\r\n        },\r\n        {\r\n          id: '37',\r\n          name: '37方案',\r\n          desc: '30%定金 + 70%尾款（无质保）',\r\n          stages: [\r\n            { name: '首付款', percent: 30, milestone: '合同签订后托管', riskNote: '覆盖30%人力成本', stageType: 1 },\r\n            { name: '尾款', percent: 70, milestone: '项目验收通过后支付', riskNote: '验收通过后一次性结清', stageType: 2 }\r\n          ]\r\n        },\r\n        {\r\n          id: '442',\r\n          name: '442方案',\r\n          desc: '40%定金 + 40%中期款 + 20%质保款',\r\n          stages: [\r\n            { name: '首付款', percent: 40, milestone: '合同签订后托管', riskNote: '较高首付降低风险', stageType: 1 },\r\n            { name: '尾款', percent: 40, milestone: '项目验收通过后支付', riskNote: '验收通过后支付', stageType: 2 },\r\n            { name: '质保款', percent: 20, milestone: '质保期15天后释放', riskNote: '15天免费维护保障', stageType: 3 }\r\n          ]\r\n        },\r\n        {\r\n          id: 'custom',\r\n          name: '自定义方案',\r\n          desc: '自由设置付款比例和节点',\r\n          stages: [\r\n            { name: '首付款', percent: 50, milestone: '合同签订后托管', riskNote: '', stageType: 1 },\r\n            { name: '尾款', percent: 50, milestone: '项目验收通过后支付', riskNote: '', stageType: 2 }\r\n          ]\r\n        }\r\n      ],\r\n      \r\n      formData: {\r\n        title: '',\r\n        categoryId: null,\r\n        categoryName: '',\r\n        techStack: '',\r\n        description: '',\r\n        features: '',\r\n        startTime: '',\r\n        deliveryTime: '',\r\n        stages: []\r\n      }\r\n    }\r\n  },\r\n  \r\n  computed: {\r\n    totalAmount() {\r\n      return this.formData.stages.reduce((sum, stage) => sum + (stage.amount || 0), 0)\r\n    },\r\n    totalPercent() {\r\n      return this.formData.stages.reduce((sum, stage) => sum + (stage.percent || 0), 0)\r\n    }\r\n  },\r\n  \r\n  onLoad() {\r\n    const systemInfo = uni.getSystemInfoSync()\r\n    this.statusBarHeight = systemInfo.statusBarHeight || 0\r\n    \r\n    // 初始化默认方案\r\n    this.selectPlan(this.paymentPlans[0])\r\n    \r\n    // 加载分类数据\r\n    this.loadCategories()\r\n  },\r\n  \r\n  methods: {\r\n    async loadCategories() {\r\n      try {\r\n        const res = await getBusinessCategories()\r\n        console.log('分类数据:', res.data)\r\n        \r\n        if (res.data && res.data.length > 0) {\r\n          this.categoryTree = res.data\r\n          \r\n          // 第一列：一级分类\r\n          const col1 = res.data.map(item => ({\r\n            id: item.id,\r\n            name: item.name,\r\n            children: item.children || []\r\n          }))\r\n          \r\n          // 第二列：第一个一级分类的二级分类\r\n          let col2 = []\r\n          if (col1.length > 0 && col1[0].children.length > 0) {\r\n            col2 = col1[0].children.map(item => ({\r\n              id: item.id,\r\n              name: item.name,\r\n              children: item.children || []\r\n            }))\r\n          }\r\n          \r\n          // 第三列：第一个二级分类的三级分类\r\n          let col3 = []\r\n          if (col2.length > 0 && col2[0].children && col2[0].children.length > 0) {\r\n            col3 = col2[0].children.map(item => ({\r\n              id: item.id,\r\n              name: item.name\r\n            }))\r\n          }\r\n          \r\n          // 设置三列数据\r\n          this.categoryColumns = [col1, col2, col3]\r\n          // 不设置默认选中，让用户自己选择\r\n          this.categoryIndexes = [0, 0, 0]\r\n          \r\n          console.log('分类列数据:', this.categoryColumns)\r\n        }\r\n      } catch (e) {\r\n        console.error('加载分类失败', e)\r\n        // 使用默认分类\r\n        this.categoryColumns = [\r\n          [\r\n            { id: 1, name: 'IT/互联网', children: [] },\r\n            { id: 2, name: '设计创意', children: [] }\r\n          ],\r\n          [\r\n            { id: 101, name: '后端开发', children: [] },\r\n            { id: 102, name: '前端开发', children: [] }\r\n          ],\r\n          [\r\n            { id: 1011, name: 'Java后端开发' },\r\n            { id: 1012, name: 'Python后端开发' }\r\n          ]\r\n        ]\r\n        this.categoryIndexes = [0, 0, 0]\r\n      }\r\n    },\r\n    goBack() {\r\n      if (this.currentStep > 1) {\r\n        this.currentStep--\r\n      } else {\r\n        uni.navigateBack()\r\n      }\r\n    },\r\n    \r\n    // 更新分类名称和ID\r\n    updateCategoryName() {\r\n      const [idx1, idx2, idx3] = this.categoryIndexes\r\n      const col1 = this.categoryColumns[0]\r\n      const col2 = this.categoryColumns[1]\r\n      const col3 = this.categoryColumns[2]\r\n      \r\n      // 检查是否有有效的分类数据\r\n      if (!col1 || col1.length === 0) {\r\n        this.formData.categoryName = ''\r\n        this.formData.categoryId = null\r\n        return\r\n      }\r\n      \r\n      if (col1[idx1] && col2[idx2] && col3[idx3]) {\r\n        // 三级分类都存在\r\n        this.formData.categoryName = `${col1[idx1].name} > ${col2[idx2].name} > ${col3[idx3].name}`\r\n        this.formData.categoryId = col3[idx3].id\r\n      } else if (col1[idx1] && col2[idx2]) {\r\n        // 只有二级分类\r\n        this.formData.categoryName = `${col1[idx1].name} > ${col2[idx2].name}`\r\n        this.formData.categoryId = col2[idx2].id\r\n      } else if (col1[idx1]) {\r\n        // 只有一级分类\r\n        this.formData.categoryName = col1[idx1].name\r\n        this.formData.categoryId = col1[idx1].id\r\n      } else {\r\n        // 没有选择任何分类\r\n        this.formData.categoryName = ''\r\n        this.formData.categoryId = null\r\n      }\r\n      \r\n      console.log('当前选中:', this.formData.categoryName, this.formData.categoryId)\r\n    },\r\n    \r\n    // 分类列变化（用户滑动某一列）\r\n    onCategoryColumnChange(e) {\r\n      const column = e.detail.column  // 第几列改变了 (0, 1, 2)\r\n      const index = e.detail.value    // 改变列的新索引\r\n      \r\n      console.log('列变化:', column, '新索引:', index)\r\n      \r\n      if (column === 0) {\r\n        // 第一列（一级分类）改变，更新第二列和第三列\r\n        const level1 = this.categoryColumns[0][index]\r\n        \r\n        if (level1 && level1.children && level1.children.length > 0) {\r\n          // 更新第二列\r\n          const newCol2 = level1.children.map(item => ({\r\n            id: item.id,\r\n            name: item.name,\r\n            children: item.children || []\r\n          }))\r\n          \r\n          // 更新第三列（使用新第二列的第一项的子分类）\r\n          let newCol3 = []\r\n          if (newCol2[0] && newCol2[0].children && newCol2[0].children.length > 0) {\r\n            newCol3 = newCol2[0].children.map(item => ({\r\n              id: item.id,\r\n              name: item.name\r\n            }))\r\n          }\r\n          \r\n          // 更新数据（必须创建新数组引用）\r\n          this.categoryColumns = [\r\n            this.categoryColumns[0],\r\n            newCol2,\r\n            newCol3\r\n          ]\r\n          this.categoryIndexes = [index, 0, 0]\r\n        }\r\n      } else if (column === 1) {\r\n        // 第二列（二级分类）改变，更新第三列\r\n        const level2 = this.categoryColumns[1][index]\r\n        \r\n        if (level2 && level2.children && level2.children.length > 0) {\r\n          const newCol3 = level2.children.map(item => ({\r\n            id: item.id,\r\n            name: item.name\r\n          }))\r\n          \r\n          this.categoryColumns = [\r\n            this.categoryColumns[0],\r\n            this.categoryColumns[1],\r\n            newCol3\r\n          ]\r\n          this.categoryIndexes = [this.categoryIndexes[0], index, 0]\r\n        } else {\r\n          // 没有三级分类\r\n          this.categoryColumns = [\r\n            this.categoryColumns[0],\r\n            this.categoryColumns[1],\r\n            []\r\n          ]\r\n          this.categoryIndexes = [this.categoryIndexes[0], index, 0]\r\n        }\r\n      } else if (column === 2) {\r\n        // 第三列改变\r\n        this.categoryIndexes = [this.categoryIndexes[0], this.categoryIndexes[1], index]\r\n      }\r\n    },\r\n    \r\n    // 分类选择确认\r\n    onCategoryChange(e) {\r\n      this.categoryIndexes = e.detail.value\r\n      this.updateCategoryName()\r\n    },\r\n    \r\n    onStartTimeChange(e) {\r\n      this.formData.startTime = e.detail.value\r\n    },\r\n    \r\n    onDeliveryTimeChange(e) {\r\n      this.formData.deliveryTime = e.detail.value\r\n    },\r\n    \r\n    chooseFile() {\r\n      uni.chooseMessageFile({\r\n        count: 9 - this.uploadedFiles.length,\r\n        type: 'all',\r\n        success: async (res) => {\r\n          const files = res.tempFiles\r\n          for (let file of files) {\r\n            await this.uploadFile(file)\r\n          }\r\n        }\r\n      })\r\n    },\r\n    \r\n    async uploadFile(file) {\r\n      uni.showLoading({ title: '上传中...' })\r\n      try {\r\n        const token = uni.getStorageSync('token')\r\n        const uploadTask = uni.uploadFile({\r\n          url: 'http://localhost:8080/api/file/upload',\r\n          filePath: file.path,\r\n          name: 'file',\r\n          header: {\r\n            'Authorization': token\r\n          },\r\n          formData: {\r\n            type: 'docs'\r\n          },\r\n          success: (res) => {\r\n            const data = JSON.parse(res.data)\r\n            if (data.code === 200) {\r\n              this.uploadedFiles.push({\r\n                name: file.name,\r\n                url: data.data.url\r\n              })\r\n              uni.showToast({ title: '上传成功', icon: 'success' })\r\n            }\r\n          }\r\n        })\r\n      } catch (e) {\r\n        uni.showToast({ title: '上传失败', icon: 'none' })\r\n      } finally {\r\n        uni.hideLoading()\r\n      }\r\n    },\r\n    \r\n    removeFile(index) {\r\n      this.uploadedFiles.splice(index, 1)\r\n    },\r\n    \r\n    isImage(filename) {\r\n      const ext = filename.split('.').pop().toLowerCase()\r\n      return ['jpg', 'jpeg', 'png', 'gif'].includes(ext)\r\n    },\r\n    \r\n    selectPlan(plan) {\r\n      this.selectedPlanId = plan.id\r\n      this.formData.stages = JSON.parse(JSON.stringify(plan.stages.map(s => ({\r\n        ...s,\r\n        amount: Math.round(this.totalBudget * s.percent / 100)\r\n      }))))\r\n    },\r\n    \r\n    onBudgetChange() {\r\n      this.recalculateStages()\r\n    },\r\n    \r\n    recalculateStages() {\r\n      this.formData.stages.forEach(stage => {\r\n        stage.amount = Math.round(this.totalBudget * stage.percent / 100)\r\n      })\r\n    },\r\n    \r\n    updateStageAmount(index) {\r\n      this.formData.stages[index].amount = Math.round(this.totalBudget * this.formData.stages[index].percent / 100)\r\n    },\r\n    \r\n    addStage() {\r\n      const remainingPercent = 100 - this.totalPercent\r\n      this.formData.stages.push({\r\n        name: `阶段${this.formData.stages.length + 1}`,\r\n        percent: Math.max(5, remainingPercent),\r\n        amount: Math.round(this.totalBudget * Math.max(5, remainingPercent) / 100),\r\n        milestone: '',\r\n        riskNote: '',\r\n        stageType: 2\r\n      })\r\n      this.selectedPlanId = 'custom'\r\n    },\r\n    \r\n    removeStage(index) {\r\n      this.formData.stages.splice(index, 1)\r\n      this.selectedPlanId = 'custom'\r\n    },\r\n    \r\n    getStageColor(index) {\r\n      const colors = ['#00AFE1', '#10B981', '#F59E0B', '#EF4444', '#8B5CF6']\r\n      return colors[index % colors.length]\r\n    },\r\n    \r\n    nextStep() {\r\n      if (this.currentStep === 1) {\r\n        if (!this.validateStep1()) return\r\n      } else if (this.currentStep === 2) {\r\n        if (!this.validateStep2()) return\r\n      }\r\n      this.currentStep++\r\n    },\r\n    \r\n    prevStep() {\r\n      this.currentStep--\r\n    },\r\n    \r\n    validateStep1() {\r\n      if (!this.formData.title) {\r\n        uni.showToast({ title: '请输入项目名称', icon: 'none' })\r\n        return false\r\n      }\r\n      if (!this.formData.categoryId) {\r\n        uni.showToast({ title: '请选择项目分类', icon: 'none' })\r\n        return false\r\n      }\r\n      if (!this.formData.description) {\r\n        uni.showToast({ title: '请输入需求简述', icon: 'none' })\r\n        return false\r\n      }\r\n      if (!this.formData.startTime) {\r\n        uni.showToast({ title: '请选择开始时间', icon: 'none' })\r\n        return false\r\n      }\r\n      if (!this.formData.deliveryTime) {\r\n        uni.showToast({ title: '请选择交付日期', icon: 'none' })\r\n        return false\r\n      }\r\n      return true\r\n    },\r\n    \r\n    validateStep2() {\r\n      if (!this.totalBudget || this.totalBudget < 100) {\r\n        uni.showToast({ title: '项目预算最低100元', icon: 'none' })\r\n        return false\r\n      }\r\n      if (this.formData.stages.some(s => !s.name || !s.amount)) {\r\n        uni.showToast({ title: '请完善所有阶段信息', icon: 'none' })\r\n        return false\r\n      }\r\n      if (this.totalPercent !== 100) {\r\n        uni.showToast({ title: `付款比例需等于100%，当前${this.totalPercent}%`, icon: 'none' })\r\n        return false\r\n      }\r\n      return true\r\n    },\r\n    \r\n    async handleSubmit() {\r\n      this.submitting = true\r\n      try {\r\n        const submitData = {\r\n          title: this.formData.title,\r\n          categoryId: this.formData.categoryId,\r\n          techStack: this.formData.techStack,\r\n          description: this.formData.description,\r\n          features: this.formData.features,\r\n          docUrls: this.uploadedFiles.map(f => f.url),\r\n          startTime: this.formData.startTime,\r\n          deliveryTime: this.formData.deliveryTime,\r\n          stages: this.formData.stages.map(s => ({\r\n            name: s.name,\r\n            amount: s.amount,\r\n            percent: s.percent,\r\n            milestone: s.milestone,\r\n            riskNote: s.riskNote,\r\n            stageType: s.stageType || 2\r\n          }))\r\n        }\r\n        \r\n        const res = await request({\r\n          url: '/order/create',\r\n          method: 'POST',\r\n          data: submitData\r\n        })\r\n        \r\n        uni.showToast({ title: '发布成功', icon: 'success' })\r\n        setTimeout(() => {\r\n          uni.reLaunch({ url: '/pages/index/index' })\r\n        }, 1500)\r\n      } catch (e) {\r\n        uni.showToast({ title: e.message || '发布失败', icon: 'none' })\r\n      } finally {\r\n        this.submitting = false\r\n      }\r\n    }\r\n  }\r\n}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.page {\r\n  min-height: 100vh;\r\n  background: #f5f7fa;\r\n}\r\n\r\n.custom-navbar {\r\n  background: #fff;\r\n  border-bottom: 1rpx solid #eee;\r\n}\r\n\r\n.navbar-content {\r\n  height: 88rpx;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  padding: 0 32rpx;\r\n}\r\n\r\n.navbar-left, .navbar-right {\r\n  width: 80rpx;\r\n}\r\n\r\n.navbar-left {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n}\r\n\r\n.back-icon {\r\n  font-size: 48rpx;\r\n  color: #333;\r\n  font-weight: 300;\r\n  line-height: 1;\r\n}\r\n\r\n.navbar-title {\r\n  font-size: 32rpx;\r\n  font-weight: 600;\r\n  color: #333;\r\n}\r\n\r\n.content-scroll {\r\n  height: calc(100vh - 88rpx);\r\n}\r\n\r\n/* 步骤指示器 */\r\n.steps {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: space-between;\r\n  background: #fff;\r\n  border-radius: 24rpx;\r\n  padding: 40rpx;\r\n  margin: 32rpx 32rpx 32rpx 32rpx;\r\n}\r\n\r\n.step {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  gap: 12rpx;\r\n}\r\n\r\n.step-number {\r\n  width: 56rpx;\r\n  height: 56rpx;\r\n  border-radius: 50%;\r\n  background: #e5e7eb;\r\n  color: #9ca3af;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  font-size: 28rpx;\r\n  font-weight: 600;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.step.active .step-number {\r\n  background: #00AFE1;\r\n  color: #fff;\r\n}\r\n\r\n.step-text {\r\n  font-size: 24rpx;\r\n  color: #9ca3af;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.step.active .step-text {\r\n  color: #00AFE1;\r\n  font-weight: 600;\r\n}\r\n\r\n.step-line {\r\n  flex: 1;\r\n  height: 4rpx;\r\n  background: #e5e7eb;\r\n  margin: 0 16rpx;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.step-line.active {\r\n  background: #00AFE1;\r\n}\r\n\r\n/* 表单区域 */\r\n.step-content {\r\n  animation: fadeIn 0.3s;\r\n}\r\n\r\n@keyframes fadeIn {\r\n  from { opacity: 0; transform: translateY(20rpx); }\r\n  to { opacity: 1; transform: translateY(0); }\r\n}\r\n\r\n.section {\r\n  background: #fff;\r\n  border-radius: 24rpx;\r\n  padding: 40rpx;\r\n  margin: 0 32rpx 24rpx 32rpx;\r\n}\r\n\r\n.section-title {\r\n  font-size: 28rpx;\r\n  font-weight: 600;\r\n  color: #333;\r\n  margin-bottom: 32rpx;\r\n  padding-left: 16rpx;\r\n  border-left: 6rpx solid #00AFE1;\r\n}\r\n\r\n.form-item {\r\n  margin-bottom: 32rpx;\r\n}\r\n\r\n.form-item.half {\r\n  width: 48%;\r\n}\r\n\r\n.form-row {\r\n  display: flex;\r\n  justify-content: space-between;\r\n}\r\n\r\n.form-label {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  margin-bottom: 16rpx;\r\n  display: block;\r\n}\r\n\r\n.form-label.required::before {\r\n  content: '*';\r\n  color: #ef4444;\r\n  margin-right: 8rpx;\r\n}\r\n\r\n.form-input, .form-picker {\r\n  height: 88rpx;\r\n  background: #f5f7fa;\r\n  border-radius: 16rpx;\r\n  padding: 0 24rpx;\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  display: flex;\r\n  align-items: center;\r\n}\r\n\r\n.form-textarea {\r\n  background: #f5f7fa;\r\n  border-radius: 16rpx;\r\n  padding: 24rpx;\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  min-height: 160rpx;\r\n}\r\n\r\n.form-textarea.large {\r\n  min-height: 320rpx;\r\n}\r\n\r\n.placeholder {\r\n  color: #9ca3af;\r\n}\r\n\r\n.char-count {\r\n  text-align: right;\r\n  font-size: 24rpx;\r\n  color: #9ca3af;\r\n  margin-top: 8rpx;\r\n}\r\n\r\n.form-tip {\r\n  font-size: 24rpx;\r\n  color: #9ca3af;\r\n  margin-top: 12rpx;\r\n}\r\n\r\n/* 文件上传 */\r\n.upload-list {\r\n  display: flex;\r\n  flex-wrap: wrap;\r\n  gap: 16rpx;\r\n}\r\n\r\n.upload-item {\r\n  width: 160rpx;\r\n  height: 160rpx;\r\n  position: relative;\r\n  border-radius: 16rpx;\r\n  overflow: hidden;\r\n}\r\n\r\n.upload-preview {\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n\r\n.upload-file {\r\n  width: 100%;\r\n  height: 100%;\r\n  background: #f5f7fa;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 8rpx;\r\n}\r\n\r\n.upload-file .iconfont {\r\n  font-size: 48rpx;\r\n  color: #9ca3af;\r\n}\r\n\r\n.file-name {\r\n  font-size: 20rpx;\r\n  color: #666;\r\n  padding: 0 8rpx;\r\n  text-align: center;\r\n  overflow: hidden;\r\n  text-overflow: ellipsis;\r\n  white-space: nowrap;\r\n  max-width: 140rpx;\r\n}\r\n\r\n.upload-delete {\r\n  position: absolute;\r\n  top: 8rpx;\r\n  right: 8rpx;\r\n  width: 40rpx;\r\n  height: 40rpx;\r\n  background: rgba(0, 0, 0, 0.6);\r\n  border-radius: 50%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  color: #fff;\r\n  font-size: 24rpx;\r\n}\r\n\r\n.upload-btn {\r\n  width: 160rpx;\r\n  height: 160rpx;\r\n  background: #f5f7fa;\r\n  border: 2rpx dashed #d1d5db;\r\n  border-radius: 16rpx;\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 8rpx;\r\n}\r\n\r\n.upload-btn .iconfont {\r\n  font-size: 48rpx;\r\n  color: #9ca3af;\r\n}\r\n\r\n.upload-text {\r\n  font-size: 24rpx;\r\n  color: #9ca3af;\r\n}\r\n\r\n/* 付款方案 */\r\n.plan-list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 16rpx;\r\n}\r\n\r\n.plan-card {\r\n  background: #f5f7fa;\r\n  border: 3rpx solid transparent;\r\n  border-radius: 16rpx;\r\n  padding: 24rpx;\r\n  transition: all 0.3s;\r\n}\r\n\r\n.plan-card.active {\r\n  background: rgba(0, 175, 225, 0.05);\r\n  border-color: #00AFE1;\r\n}\r\n\r\n.plan-header {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 8rpx;\r\n}\r\n\r\n.plan-name {\r\n  font-size: 28rpx;\r\n  font-weight: 600;\r\n  color: #333;\r\n}\r\n\r\n.plan-check {\r\n  width: 40rpx;\r\n  height: 40rpx;\r\n  background: #00AFE1;\r\n  border-radius: 50%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  color: #fff;\r\n  font-size: 24rpx;\r\n}\r\n\r\n.plan-desc {\r\n  font-size: 24rpx;\r\n  color: #666;\r\n}\r\n\r\n/* 预算输入 */\r\n.budget-input {\r\n  display: flex;\r\n  align-items: center;\r\n  background: #f5f7fa;\r\n  border-radius: 16rpx;\r\n  padding: 0 24rpx;\r\n  height: 120rpx;\r\n}\r\n\r\n.budget-symbol {\r\n  font-size: 48rpx;\r\n  font-weight: 600;\r\n  color: #00AFE1;\r\n  margin-right: 16rpx;\r\n}\r\n\r\n.budget-value {\r\n  flex: 1;\r\n  font-size: 48rpx;\r\n  font-weight: 600;\r\n  color: #333;\r\n}\r\n\r\n/* 阶段卡片 */\r\n.stage-list {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 24rpx;\r\n}\r\n\r\n.stage-card {\r\n  background: #f5f7fa;\r\n  border-radius: 16rpx;\r\n  padding: 24rpx;\r\n}\r\n\r\n.stage-header {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 16rpx;\r\n  margin-bottom: 24rpx;\r\n}\r\n\r\n.stage-number {\r\n  width: 56rpx;\r\n  height: 56rpx;\r\n  border-radius: 50%;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  color: #fff;\r\n  font-size: 28rpx;\r\n  font-weight: 600;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.stage-name {\r\n  flex: 1;\r\n  height: 56rpx;\r\n  background: #fff;\r\n  border-radius: 12rpx;\r\n  padding: 0 16rpx;\r\n  font-size: 28rpx;\r\n}\r\n\r\n.stage-delete {\r\n  width: 56rpx;\r\n  height: 56rpx;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  color: #ef4444;\r\n  font-size: 32rpx;\r\n}\r\n\r\n.stage-amount {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n.amount-input {\r\n  display: flex;\r\n  align-items: center;\r\n  background: #fff;\r\n  border-radius: 12rpx;\r\n  padding: 0 16rpx;\r\n  height: 64rpx;\r\n  width: 160rpx;\r\n}\r\n\r\n.amount-input input {\r\n  flex: 1;\r\n  font-size: 28rpx;\r\n  text-align: right;\r\n}\r\n\r\n.amount-input text {\r\n  font-size: 24rpx;\r\n  color: #666;\r\n  margin-left: 8rpx;\r\n}\r\n\r\n.amount-value {\r\n  font-size: 32rpx;\r\n  font-weight: 600;\r\n  color: #00AFE1;\r\n}\r\n\r\n.stage-field {\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n.stage-field:last-child {\r\n  margin-bottom: 0;\r\n}\r\n\r\n.field-label {\r\n  font-size: 24rpx;\r\n  color: #666;\r\n  margin-bottom: 8rpx;\r\n  display: block;\r\n}\r\n\r\n.field-input {\r\n  height: 64rpx;\r\n  background: #fff;\r\n  border-radius: 12rpx;\r\n  padding: 0 16rpx;\r\n  font-size: 26rpx;\r\n}\r\n\r\n.field-textarea {\r\n  background: #fff;\r\n  border-radius: 12rpx;\r\n  padding: 16rpx;\r\n  font-size: 26rpx;\r\n  min-height: 120rpx;\r\n}\r\n\r\n.add-stage-btn {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  gap: 12rpx;\r\n  height: 88rpx;\r\n  background: transparent;\r\n  border: 2rpx dashed #00AFE1;\r\n  border-radius: 16rpx;\r\n  color: #00AFE1;\r\n  font-size: 28rpx;\r\n  font-weight: 600;\r\n  margin-top: 24rpx;\r\n}\r\n\r\n.percent-warning {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 12rpx;\r\n  background: #fef2f2;\r\n  border: 2rpx solid #fecaca;\r\n  border-radius: 12rpx;\r\n  padding: 16rpx;\r\n  margin-top: 24rpx;\r\n  color: #ef4444;\r\n  font-size: 24rpx;\r\n}\r\n\r\n/* 信息提示框 */\r\n.info-box {\r\n  background: #eff6ff;\r\n  border: 2rpx solid #bfdbfe;\r\n  border-radius: 16rpx;\r\n  padding: 24rpx;\r\n  margin: 0 32rpx 24rpx 32rpx;\r\n}\r\n\r\n.info-title {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 8rpx;\r\n  font-size: 26rpx;\r\n  font-weight: 600;\r\n  color: #1e40af;\r\n  margin-bottom: 16rpx;\r\n}\r\n\r\n.info-item {\r\n  font-size: 24rpx;\r\n  color: #3b82f6;\r\n  line-height: 1.8;\r\n}\r\n\r\n/* 确认信息 */\r\n.confirm-item {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  padding: 24rpx 0;\r\n  border-bottom: 1rpx solid #f5f7fa;\r\n}\r\n\r\n.confirm-item:last-child {\r\n  border-bottom: none;\r\n}\r\n\r\n.confirm-label {\r\n  font-size: 28rpx;\r\n  color: #666;\r\n}\r\n\r\n.confirm-value {\r\n  font-size: 28rpx;\r\n  color: #333;\r\n  font-weight: 500;\r\n  text-align: right;\r\n  max-width: 60%;\r\n}\r\n\r\n.confirm-budget {\r\n  display: flex;\r\n  justify-content: space-between;\r\n  align-items: center;\r\n  padding: 32rpx;\r\n  background: linear-gradient(135deg, #00AFE1 0%, #0084A8 100%);\r\n  border-radius: 16rpx;\r\n  margin-bottom: 24rpx;\r\n}\r\n\r\n.budget-label {\r\n  font-size: 28rpx;\r\n  color: rgba(255, 255, 255, 0.8);\r\n}\r\n\r\n.budget-amount {\r\n  font-size: 48rpx;\r\n  font-weight: 900;\r\n  color: #fff;\r\n}\r\n\r\n.stage-summary {\r\n  display: flex;\r\n  flex-direction: column;\r\n  gap: 16rpx;\r\n}\r\n\r\n.summary-item {\r\n  display: flex;\r\n  align-items: center;\r\n  gap: 16rpx;\r\n  padding: 16rpx;\r\n  background: #f5f7fa;\r\n  border-radius: 12rpx;\r\n}\r\n\r\n.summary-dot {\r\n  width: 16rpx;\r\n  height: 16rpx;\r\n  border-radius: 50%;\r\n}\r\n\r\n.summary-name {\r\n  flex: 1;\r\n  font-size: 26rpx;\r\n  color: #333;\r\n}\r\n\r\n.summary-percent {\r\n  font-size: 24rpx;\r\n  color: #666;\r\n}\r\n\r\n.summary-amount {\r\n  font-size: 28rpx;\r\n  font-weight: 600;\r\n  color: #00AFE1;\r\n}\r\n\r\n/* 警告框 */\r\n.warning-box {\r\n  display: flex;\r\n  align-items: flex-start;\r\n  gap: 16rpx;\r\n  background: #fffbeb;\r\n  border: 2rpx solid #fde68a;\r\n  border-radius: 16rpx;\r\n  padding: 24rpx;\r\n  margin: 0 32rpx 24rpx 32rpx;\r\n}\r\n\r\n.warning-box .iconfont {\r\n  font-size: 32rpx;\r\n  color: #f59e0b;\r\n  flex-shrink: 0;\r\n}\r\n\r\n.warning-text {\r\n  flex: 1;\r\n  font-size: 24rpx;\r\n  color: #92400e;\r\n  line-height: 1.6;\r\n}\r\n\r\n/* 按钮组 */\r\n.btn-group {\r\n  display: flex;\r\n  gap: 24rpx;\r\n  margin: 32rpx 32rpx 0 32rpx;\r\n}\r\n\r\n.btn {\r\n  flex: 1;\r\n  height: 96rpx;\r\n  border-radius: 48rpx;\r\n  font-size: 32rpx;\r\n  font-weight: 600;\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: center;\r\n  border: none;\r\n}\r\n\r\n.btn-default {\r\n  background: #f5f7fa;\r\n  color: #666;\r\n}\r\n\r\n.btn-primary {\r\n  background: linear-gradient(135deg, #00AFE1 0%, #0084A8 100%);\r\n  color: #fff;\r\n}\r\n</style>\r\n","import mod from \"-!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./create.vue?vue&type=style&index=0&id=d90dac46&lang=scss&scoped=true&\"; export default mod; export * from \"-!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\mini-css-extract-plugin\\\\dist\\\\loader.js??ref--8-oneOf-1-0!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\css-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-1!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\loaders\\\\stylePostLoader.js!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-2!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\postcss-loader\\\\src\\\\index.js??ref--8-oneOf-1-3!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\sass-loader\\\\dist\\\\cjs.js??ref--8-oneOf-1-4!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\webpack-preprocess-loader\\\\index.js??ref--8-oneOf-1-5!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\vue-cli-plugin-uni\\\\packages\\\\vue-loader\\\\lib\\\\index.js??vue-loader-options!A:\\\\HBuilderX\\\\plugins\\\\uniapp-cli\\\\node_modules\\\\@dcloudio\\\\webpack-uni-mp-loader\\\\lib\\\\style.js!./create.vue?vue&type=style&index=0&id=d90dac46&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1770381686801\n      var cssReload = require(\"A:/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"/\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}