<view class="page data-v-102f0ee6"><scroll-view class="content-scroll data-v-102f0ee6" scroll-y="{{true}}"><view class="contract-header data-v-102f0ee6"><text class="contract-title data-v-102f0ee6">{{contract.title}}</text><text class="contract-no data-v-102f0ee6">{{"合同编号: "+contract.contractNo}}</text></view><view class="parties-card data-v-102f0ee6"><view class="party-item data-v-102f0ee6"><text class="party-label data-v-102f0ee6">甲方（委托方）</text><text class="party-name data-v-102f0ee6">{{contract.partyAName}}</text><view class="{{['sign-status','data-v-102f0ee6',(contract.partyASignTime)?'signed':'']}}">{{''+(contract.partyASignTime?'✓ 已签署':'待签署')+''}}</view></view><view class="party-divider data-v-102f0ee6"></view><view class="party-item data-v-102f0ee6"><text class="party-label data-v-102f0ee6">乙方（服务方）</text><text class="party-name data-v-102f0ee6">{{contract.partyBName}}</text><view class="{{['sign-status','data-v-102f0ee6',(contract.partyBSignTime)?'signed':'']}}">{{''+(contract.partyBSignTime?'✓ 已签署':'待签署')+''}}</view></view></view><view class="amount-card data-v-102f0ee6"><text class="amount-label data-v-102f0ee6">合同总金额</text><text class="amount-value data-v-102f0ee6">{{"¥"+$root.m0}}</text></view><view class="content-card data-v-102f0ee6"><view class="content-section data-v-102f0ee6"><text class="section-title data-v-102f0ee6">项目描述</text><text class="section-text data-v-102f0ee6">{{contract.projectDesc}}</text></view><block wx:if="{{contract.techRequirements}}"><view class="content-section data-v-102f0ee6"><text class="section-title data-v-102f0ee6">技术要求</text><text class="section-text data-v-102f0ee6">{{contract.techRequirements}}</text></view></block><view class="content-section data-v-102f0ee6"><text class="section-title data-v-102f0ee6">验收标准</text><text class="section-text data-v-102f0ee6">{{contract.deliveryStandard}}</text></view><block wx:if="{{contract.deliveryDeadline}}"><view class="content-section data-v-102f0ee6"><text class="section-title data-v-102f0ee6">交付期限</text><text class="section-text data-v-102f0ee6">{{$root.m1}}</text></view></block></view><block wx:if="{{$root.g0>0}}"><view class="stages-card data-v-102f0ee6"><text class="card-title data-v-102f0ee6">付款阶段</text><block wx:for="{{$root.l0}}" wx:for-item="stage" wx:for-index="index" wx:key="index"><view class="stage-item data-v-102f0ee6"><view class="stage-number data-v-102f0ee6">{{index+1}}</view><view class="stage-info data-v-102f0ee6"><text class="stage-name data-v-102f0ee6">{{stage.$orig.stageName}}</text><text class="stage-milestone data-v-102f0ee6">{{stage.$orig.milestone}}</text></view><view class="stage-amount data-v-102f0ee6"><text class="amount data-v-102f0ee6">{{"¥"+stage.m2}}</text><text class="percent data-v-102f0ee6">{{stage.$orig.percent+"%"}}</text></view></view></block></view></block><view class="clauses-card data-v-102f0ee6"><text class="card-title data-v-102f0ee6">法律条款</text><block wx:if="{{contract.breachClause}}"><view class="clause-section data-v-102f0ee6"><text class="clause-title data-v-102f0ee6">违约条款</text><text class="clause-text data-v-102f0ee6">{{contract.breachClause}}</text></view></block><block wx:if="{{contract.confidentialClause}}"><view class="clause-section data-v-102f0ee6"><text class="clause-title data-v-102f0ee6">保密协议</text><text class="clause-text data-v-102f0ee6">{{contract.confidentialClause}}</text></view></block><block wx:if="{{contract.ipClause}}"><view class="clause-section data-v-102f0ee6"><text class="clause-title data-v-102f0ee6">知识产权归属</text><text class="clause-text data-v-102f0ee6">{{contract.ipClause}}</text></view></block><block wx:if="{{contract.disputeClause}}"><view class="clause-section data-v-102f0ee6"><text class="clause-title data-v-102f0ee6">争议解决方式</text><text class="clause-text data-v-102f0ee6">{{contract.disputeClause}}</text></view></block></view><block wx:if="{{canSign}}"><view class="agree-card data-v-102f0ee6"><checkbox-group data-event-opts="{{[['change',[['onAgreeChange',['$event']]]]]}}" bindchange="__e" class="data-v-102f0ee6"><label class="agree-label data-v-102f0ee6"><checkbox value="agree" checked="{{agreed}}" class="data-v-102f0ee6"></checkbox><text class="agree-text data-v-102f0ee6">我已阅读并同意以上合同条款</text></label></checkbox-group></view></block><block wx:if="{{canSign&&agreed}}"><view class="signature-card data-v-102f0ee6"><view class="signature-header data-v-102f0ee6"><text class="signature-title data-v-102f0ee6">请在下方签名</text><button data-event-opts="{{[['tap',[['clearSignature',['$event']]]]]}}" class="clear-btn data-v-102f0ee6" bindtap="__e">清除</button></view><view class="{{['signature-canvas-wrapper','data-v-102f0ee6',(hasSignature)?'has-signature':'']}}"><canvas class="signature-canvas data-v-102f0ee6" canvas-id="signatureCanvas" disable-scroll="true" data-event-opts="{{[['touchstart',[['touchStart',['$event']]]],['touchmove',[['touchMove',['$event']]]],['touchend',[['touchEnd',['$event']]]]]}}" bindtouchstart="__e" bindtouchmove="__e" bindtouchend="__e"></canvas><block wx:if="{{!hasSignature}}"><view class="signature-placeholder data-v-102f0ee6"><text class="placeholder-icon data-v-102f0ee6">✍️</text><text class="placeholder-text data-v-102f0ee6">请用手指在此处签名</text></view></block></view><text class="signature-tip data-v-102f0ee6">签名将作为您同意合同的法律凭证</text></view></block><view style="height:200rpx;" class="data-v-102f0ee6"></view></scroll-view><block wx:if="{{canSign}}"><view class="bottom-bar data-v-102f0ee6"><button class="sign-btn data-v-102f0ee6" disabled="{{!agreed||!hasSignature}}" data-event-opts="{{[['tap',[['handleSign',['$event']]]]]}}" bindtap="__e"> 确认签署 </button></view></block><block wx:else><block wx:if="{{alreadySigned}}"><view class="bottom-bar data-v-102f0ee6"><view class="signed-tip data-v-102f0ee6"><text class="signed-icon data-v-102f0ee6">✓</text><text class="signed-text data-v-102f0ee6">您已签署此合同</text></view></view></block></block></view>