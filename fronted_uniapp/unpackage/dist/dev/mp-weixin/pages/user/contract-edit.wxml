<view class="page data-v-44d71a5a"><view class="steps data-v-44d71a5a"><view class="{{['step-item','data-v-44d71a5a',(currentStep>=1)?'active':'',(currentStep>1)?'completed':'']}}"><view class="step-circle data-v-44d71a5a">1</view><text class="step-text data-v-44d71a5a">基本信息</text></view><view class="{{['step-line','data-v-44d71a5a',(currentStep>1)?'active':'']}}"></view><view class="{{['step-item','data-v-44d71a5a',(currentStep>=2)?'active':'',(currentStep>2)?'completed':'']}}"><view class="step-circle data-v-44d71a5a">2</view><text class="step-text data-v-44d71a5a">付款条款</text></view><view class="{{['step-line','data-v-44d71a5a',(currentStep>2)?'active':'']}}"></view><view class="{{['step-item','data-v-44d71a5a',(currentStep>=3)?'active':'']}}"><view class="step-circle data-v-44d71a5a">3</view><text class="step-text data-v-44d71a5a">法律条款</text></view></view><scroll-view class="content-scroll data-v-44d71a5a" scroll-y="{{true}}"><block wx:if="{{currentStep===1}}"><view class="step-content data-v-44d71a5a"><view class="form-card data-v-44d71a5a"><view class="card-title data-v-44d71a5a">合同基本信息</view><view class="form-item data-v-44d71a5a"><text class="form-label data-v-44d71a5a">合同标题 <text class="required data-v-44d71a5a">*</text></text><input class="form-input data-v-44d71a5a" placeholder="请输入合同标题" data-event-opts="{{[['input',[['__set_model',['$0','title','$event',[]],['form']]]]]}}" value="{{form.title}}" bindinput="__e"/></view><view class="form-item data-v-44d71a5a"><text class="form-label data-v-44d71a5a">甲方（委托方）</text><view class="form-readonly data-v-44d71a5a">{{order.buyerName||'加载中...'}}</view></view><view class="form-item data-v-44d71a5a"><text class="form-label data-v-44d71a5a">乙方（服务方）</text><view class="form-readonly data-v-44d71a5a">当前用户</view></view><view class="form-item data-v-44d71a5a"><text class="form-label data-v-44d71a5a">项目描述 <text class="required data-v-44d71a5a">*</text></text><textarea class="form-textarea data-v-44d71a5a" placeholder="详细描述项目内容、功能需求等" maxlength="{{500}}" data-event-opts="{{[['input',[['__set_model',['$0','projectDesc','$event',[]],['form']]]]]}}" value="{{form.projectDesc}}" bindinput="__e"></textarea><text class="char-count data-v-44d71a5a">{{$root.g0+"/500"}}</text></view><view class="form-item data-v-44d71a5a"><text class="form-label data-v-44d71a5a">技术要求</text><textarea class="form-textarea data-v-44d71a5a" placeholder="描述技术栈、架构要求等" maxlength="{{300}}" data-event-opts="{{[['input',[['__set_model',['$0','techRequirements','$event',[]],['form']]]]]}}" value="{{form.techRequirements}}" bindinput="__e"></textarea><text class="char-count data-v-44d71a5a">{{$root.g1+"/300"}}</text></view><view class="form-item data-v-44d71a5a"><text class="form-label data-v-44d71a5a">验收标准 <text class="required data-v-44d71a5a">*</text></text><textarea class="form-textarea data-v-44d71a5a" placeholder="详细描述项目验收标准、交付物要求等" maxlength="{{500}}" data-event-opts="{{[['input',[['__set_model',['$0','deliveryStandard','$event',[]],['form']]]]]}}" value="{{form.deliveryStandard}}" bindinput="__e"></textarea><text class="char-count data-v-44d71a5a">{{$root.g2+"/500"}}</text></view><view class="form-item data-v-44d71a5a"><text class="form-label data-v-44d71a5a">交付期限</text><picker mode="date" value="{{form.deliveryDeadline}}" data-event-opts="{{[['change',[['onDateChange',['$event']]]]]}}" bindchange="__e" class="data-v-44d71a5a"><view class="form-picker data-v-44d71a5a">{{''+(form.deliveryDeadline||'请选择交付日期')+''}}</view></picker></view></view></view></block><block wx:if="{{currentStep===2}}"><view class="step-content data-v-44d71a5a"><view class="form-card data-v-44d71a5a"><view class="card-title data-v-44d71a5a">付款条款</view><view class="amount-card data-v-44d71a5a"><text class="amount-label data-v-44d71a5a">合同总金额</text><text class="amount-value data-v-44d71a5a">{{"¥"+(order.totalAmount?$root.g3:'0')}}</text></view><view class="stages-list data-v-44d71a5a"><block wx:for="{{$root.l0}}" wx:for-item="stage" wx:for-index="index" wx:key="index"><view class="stage-item data-v-44d71a5a"><view class="stage-number data-v-44d71a5a">{{index+1}}</view><view class="stage-info data-v-44d71a5a"><text class="stage-name data-v-44d71a5a">{{stage.$orig.stageName}}</text><text class="stage-milestone data-v-44d71a5a">{{stage.$orig.milestone}}</text></view><view class="stage-amount data-v-44d71a5a"><text class="amount data-v-44d71a5a">{{"¥"+(stage.$orig.amount?stage.g4:'0')}}</text><text class="percent data-v-44d71a5a">{{stage.$orig.percent+"%"}}</text></view></view></block></view></view></view></block><block wx:if="{{currentStep===3}}"><view class="step-content data-v-44d71a5a"><view class="form-card data-v-44d71a5a"><view class="card-title data-v-44d71a5a">法律条款</view><view class="clause-item data-v-44d71a5a"><view data-event-opts="{{[['tap',[['toggleClause',['breach']]]]]}}" class="clause-header data-v-44d71a5a" bindtap="__e"><text class="clause-title data-v-44d71a5a">违约条款</text><text class="clause-icon data-v-44d71a5a">{{expandedClauses.breach?'▼':'▶'}}</text></view><block wx:if="{{expandedClauses.breach}}"><textarea class="clause-textarea data-v-44d71a5a" maxlength="{{500}}" data-event-opts="{{[['input',[['__set_model',['$0','breachClause','$event',[]],['form']]]]]}}" value="{{form.breachClause}}" bindinput="__e"></textarea></block></view><view class="clause-item data-v-44d71a5a"><view data-event-opts="{{[['tap',[['toggleClause',['confidential']]]]]}}" class="clause-header data-v-44d71a5a" bindtap="__e"><text class="clause-title data-v-44d71a5a">保密协议</text><text class="clause-icon data-v-44d71a5a">{{expandedClauses.confidential?'▼':'▶'}}</text></view><block wx:if="{{expandedClauses.confidential}}"><textarea class="clause-textarea data-v-44d71a5a" maxlength="{{500}}" data-event-opts="{{[['input',[['__set_model',['$0','confidentialClause','$event',[]],['form']]]]]}}" value="{{form.confidentialClause}}" bindinput="__e"></textarea></block></view><view class="clause-item data-v-44d71a5a"><view data-event-opts="{{[['tap',[['toggleClause',['ip']]]]]}}" class="clause-header data-v-44d71a5a" bindtap="__e"><text class="clause-title data-v-44d71a5a">知识产权归属</text><text class="clause-icon data-v-44d71a5a">{{expandedClauses.ip?'▼':'▶'}}</text></view><block wx:if="{{expandedClauses.ip}}"><textarea class="clause-textarea data-v-44d71a5a" maxlength="{{500}}" data-event-opts="{{[['input',[['__set_model',['$0','ipClause','$event',[]],['form']]]]]}}" value="{{form.ipClause}}" bindinput="__e"></textarea></block></view><view class="clause-item data-v-44d71a5a"><view data-event-opts="{{[['tap',[['toggleClause',['dispute']]]]]}}" class="clause-header data-v-44d71a5a" bindtap="__e"><text class="clause-title data-v-44d71a5a">争议解决方式</text><text class="clause-icon data-v-44d71a5a">{{expandedClauses.dispute?'▼':'▶'}}</text></view><block wx:if="{{expandedClauses.dispute}}"><textarea class="clause-textarea data-v-44d71a5a" maxlength="{{500}}" data-event-opts="{{[['input',[['__set_model',['$0','disputeClause','$event',[]],['form']]]]]}}" value="{{form.disputeClause}}" bindinput="__e"></textarea></block></view></view></view></block><view style="height:200rpx;" class="data-v-44d71a5a"></view></scroll-view><view class="bottom-bar data-v-44d71a5a"><view class="btn-group data-v-44d71a5a"><block wx:if="{{currentStep>1}}"><button data-event-opts="{{[['tap',[['prevStep',['$event']]]]]}}" class="btn btn-secondary data-v-44d71a5a" bindtap="__e"> 上一步 </button></block><block wx:if="{{currentStep<3}}"><button data-event-opts="{{[['tap',[['nextStep',['$event']]]]]}}" class="btn btn-primary data-v-44d71a5a" bindtap="__e"> 下一步 </button></block><block wx:if="{{currentStep===3}}"><button data-event-opts="{{[['tap',[['saveDraft',['$event']]]]]}}" class="btn btn-secondary data-v-44d71a5a" bindtap="__e"> 保存草稿 </button></block><block wx:if="{{currentStep===3}}"><button data-event-opts="{{[['tap',[['submitContract',['$event']]]]]}}" class="btn btn-primary data-v-44d71a5a" bindtap="__e"> 提交并签署 </button></block></view></view></view>